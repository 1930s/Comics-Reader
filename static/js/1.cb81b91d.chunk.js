(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{80:function(e,t,n){"use strict";n.r(t);var a=n(11),o=n(8),i=n(10),s=n(6),r=n(9),l=n(0),c=n.n(l),p=n(5),h=n(32),u=n(33),d=n(79),m=n.n(d),f=n(30),b=n(78),g=n.n(b);n(73);var v=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(r.a)(t).call(this,e))).showPhotoSwipe=function(e){return function(t){t.preventDefault();var n=Object(u.a)(Object(u.a)(n)),a=n.state.options;a.index=e,a.getThumbBoundsFn=a.getThumbBoundsFn||function(e){var t=n.thumbnails[e],a=window.pageYOffset||document.documentElement.scrollTop,o=t.getBoundingClientRect();return{x:o.left,y:o.top+a,w:o.width}},n.setState({isOpen:!0,options:a})}},n.handleResize=m()(function(){n.resizeGallery(Math.floor(n._gallery.clientWidth)),n.loadImages()},10),n.handleClose=function(){n.setState({isOpen:!1}),n.props.onClose()},n.handleScroll=m()(function(){return n.loadImages()},10),n.state={isOpen:!1,options:n.props.options,containerWidth:0},n.thumbnails=[],n}return Object(i.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize),window.addEventListener("scroll",this.handleScroll),this.handleResize(),this.handleScroll()}},{key:"componentDidUpdate",value:function(){this._gallery.clientWidth!==this.state.containerWidth&&this.handleResize()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize,!1),window.removeEventListener("scroll",this.handleScroll,!1)}},{key:"loadImages",value:function(){this.thumbnails.filter(function(e){return!e.src&&((t=e.getBoundingClientRect()).top>=0&&t.left>=0&&t.top<=(window.innerHeight||document.documentElement.clientHeight));var t}).forEach(function(e){e.src=e.getAttribute("data-src")})}},{key:"resizeGallery",value:function(e){var t=function(e){return e>=1024?9:e>=480?6:3}(e),n=e-6*t;n=Math.floor(n-2);var a,o=this.props.items.length%t;o&&(a=this.props.items.length-o);for(var i=0,s=0;s<this.props.items.length;s+=t){for(var r=0,l=0,c=s;c<s+t&&c!==this.props.items.length;c++)r+=this.props.items[c].aspectRatio;l=s===a?i||Math.min(200,n/r):n/r;for(var p=s;p<s+t&&p!==this.props.items.length;p++)this.thumbnails[p].height=l,this.thumbnails[p].width=l*this.props.items[p].aspectRatio;i=l}return[]}},{key:"getThumbSize",value:function(e,t){return{width:200,height:e*(200/t)}}},{key:"render",value:function(){var e=this,t=this.props.items,n=this.state,a=n.isOpen,o=n.options;return c.a.createElement("div",{className:"pswp-gallery"},c.a.createElement("div",{className:"Gallery",ref:function(t){e._gallery=t}},this.props.items.map(function(t,n){return c.a.createElement("div",{key:n,className:"Gallery__item",onClick:e.showPhotoSwipe(n)},c.a.createElement("img",Object.assign({"data-src":t.thumbnail,"data-key":n,alt:"Page ".concat(n),onLoad:e.handleResize,ref:function(t){t&&(e.thumbnails[t.getAttribute("data-key")]=t)}},e.getThumbSize(t.h,t.w))),c.a.createElement("span",{className:"Gallery__page"},n+1))})),c.a.createElement(f.a,null,c.a.createElement(g.a,{isOpen:a,items:t,options:o,onClose:this.handleClose,afterChange:this.props.afterChange})))}}]),Object(o.a)(t,e),t}(c.a.Component);v.defaultProps={options:{},onClose:function(){},afterChange:function(){}},v.displayName="PhotoSwipe";var O=n(13),w=function(e){function t(){var e,n,o;Object(a.a)(this,t);for(var i=arguments.length,l=new Array(i),c=0;c<i;c++)l[c]=arguments[c];return Object(s.a)(o,(n=o=Object(s.a)(this,(e=Object(r.a)(t)).call.apply(e,[this].concat(l))),o.currentPage=-1,o.afterChange=function(e){o.currentPage=e.items.indexOf(e.currItem)},o.handleClose=function(){var e=o.props.pages.length;o.currentPage+1>e-3&&!o.props.read&&o.props.onRead()},n))}return Object(i.a)(t,[{key:"render",value:function(){var e=this.props.pages.map(function(e){return{src:Object(O.d)("big",e.src),thumbnail:Object(O.d)("small",e.src),w:e.width,h:e.height,aspectRatio:e.width/e.height}});return c.a.createElement("div",null,c.a.createElement("div",{className:"BookInfo"},this.props.read&&"You read this book",this.props.read||c.a.createElement("div",null,"You did not read this book"," ",c.a.createElement("button",{className:"Button",onClick:this.props.onRead},"Mark as read"))),c.a.createElement(v,{items:e,options:{history:!1,shareEl:!1},afterChange:this.afterChange,onClose:this.handleClose}))}}]),Object(o.a)(t,e),t}(c.a.Component);w.displayName="Book";var y=n(31),k=n(15),j=n(17),C=n(12),E=function(e){function t(){var e,n,o;Object(a.a)(this,t);for(var i=arguments.length,l=new Array(i),c=0;c<i;c++)l[c]=arguments[c];return Object(s.a)(o,(n=o=Object(s.a)(this,(e=Object(r.a)(t)).call.apply(e,[this].concat(l))),o.handleRead=function(){o.props.dispatch(Object(k.d)(o.props.path))},n))}return Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.pages.length||this.props.dispatch(Object(y.b)(this.props.path)),this.props.dispatch(Object(j.b)(this.props.book.name,this.props.location.pathname,this.props.parent))}},{key:"componentWillReceiveProps",value:function(e){e.book.name!==this.props.book.name&&(this.props.dispatch(Object(j.b)(e.book.name,e.location.pathname,e.parent)),e.pages.length||this.props.dispatch(Object(y.b)(e.path)))}},{key:"componentWillUnmount",value:function(){this.unmounting=!0}},{key:"render",value:function(){return this.props.pages.length?c.a.createElement("div",{className:"Content Content--gallery"},c.a.createElement(w,{pages:this.props.pages,read:this.props.read,onRead:this.handleRead})):c.a.createElement(h.a,null)}}]),Object(o.a)(t,e),t}(c.a.Component);t.default=Object(p.b)(function(e,t){var n=t.location&&t.location.pathname.replace("/book/","")||"",a=Object(C.d)(e,n.replace(/%23/g,"#"));return{path:n,book:a.book,parent:a.parent,pages:a.pages,read:Object(k.b)(e.read.read,n)}})(E);E.displayName="BookManager"}}]);
//# sourceMappingURL=1.cb81b91d.chunk.js.map